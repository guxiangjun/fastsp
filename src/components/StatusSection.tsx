import { Mic, Loader2 } from "lucide-react";
import { AudioVisualizer } from "./AudioVisualizer";

interface StatusSectionProps {
    isRecording: boolean;
    modelReady: boolean;
    isLoading?: boolean;
    onSettingsClick: () => void;
}

export function StatusSection({ isRecording, modelReady, isLoading, onSettingsClick }: StatusSectionProps) {
    return (
        <div className="flex flex-col items-center justify-center py-12 relative">
            {/* Main Pulse Visualizer */}
            <button
                onClick={(!modelReady && !isLoading) ? onSettingsClick : undefined}
                disabled={isRecording || isLoading}
                className="relative z-10 outline-none"
            >
                <div className={`w-32 h-32 md:w-40 md:h-40 rounded-full flex items-center justify-center transition-all duration-500 relative z-20 ${isRecording
                    ? "bg-gradient-to-br from-chinese-indigo/80 to-chinese-indigo/40 backdrop-blur-sm animate-core-breathe"
                    : isLoading
                        ? "bg-chinese-indigo/5 border border-chinese-indigo/20 shadow-[0_0_40px_rgba(22,97,171,0.2)] animate-pulse"
                        : !modelReady
                            ? "bg-slate-50 shadow-[0_0_30px_rgba(15,23,42,0.1)] hover:bg-slate-100 cursor-pointer animate-pulse"
                            : "bg-white shadow-xl shadow-slate-300/50"
                    }`}>
                    {isLoading ? (
                        <Loader2 className="w-12 h-12 md:w-16 md:h-16 text-chinese-indigo/60 animate-spin" />
                    ) : (
                        <Mic className={`w-12 h-12 md:w-16 md:h-16 transition-colors duration-300 ${isRecording ? "text-white/90 animate-pulse"
                            : !modelReady ? "text-slate-400"
                                : "text-slate-300"
                            }`} />
                    )}
                </div>

                {isRecording && (
                    <div className="absolute inset-0 z-0 flex items-center justify-center pointer-events-none">
                        {/* Sci-Fi Cloud Visualizer - larger than button to allow "cloud" to expand */}
                        <AudioVisualizer
                            isRecording={isRecording}
                            className="w-64 h-64 md:w-80 md:h-80 opacity-90"
                        />
                    </div>
                )}
            </button>

            {/* Status Text */}
            <div className="mt-8 text-center space-y-2 z-10">
                <h1 className={`text-3xl md:text-4xl font-bold tracking-tight transition-all ${isRecording
                    ? "text-transparent bg-clip-text bg-gradient-to-r from-chinese-indigo to-chinese-indigo/60"
                    : isLoading
                        ? "text-chinese-indigo/60 animate-pulse"
                        : !modelReady ? "text-slate-500"
                            : "text-slate-800"
                    }`}>
                    {isRecording ? "Listening..." : isLoading ? "Loading Model..." : !modelReady ? "Setup Required" : "FastSP"}
                </h1>
                <button
                    onClick={onSettingsClick}
                    className={`text-sm md:text-base transition-colors hover:underline ${isRecording ? "text-chinese-indigo/60"
                        : isLoading
                            ? "text-chinese-indigo/60"
                            : !modelReady ? "text-chinese-indigo/80 font-medium"
                                : "text-slate-400"
                        }`}>
                    {isRecording ? "Speak clearly..." : isLoading ? "Please wait..." : !modelReady ? "Click to Download Model" : "Ready to transcribe"}
                </button>
            </div>
        </div>
    );
}
